{{/* Site Scripts */}}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // 更新危急项目数量
    const atRiskCount = document.getElementById('at-risk-count');
    if (atRiskCount) {
        const criticalCards = document.querySelectorAll('.project-card[data-health="critical"]');
        atRiskCount.textContent = criticalCards.length;
    }
    
    // 更新所有危急计数
    document.querySelectorAll('.critical-count').forEach(el => {
        const criticalCards = document.querySelectorAll('.project-card[data-health="critical"]');
        el.textContent = criticalCards.length;
    });
    
    // URL 参数筛选支持
    const urlParams = new URLSearchParams(window.location.search);
    const filterParam = urlParams.get('filter');
    if (filterParam) {
        const healthFilter = document.getElementById('health-filter');
        if (healthFilter) {
            healthFilter.value = filterParam;
            healthFilter.dispatchEvent(new Event('change'));
        }
    }
    
    // 平滑滚动
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });
    });
});
</script>
